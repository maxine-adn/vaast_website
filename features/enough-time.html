<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <!-- jsPsych core library and plugins -->
    <script src="https://unpkg.com/jspsych@8.2.1"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-call-function@2.1.0"></script>

    <!-- style sheet -->
    <link
      href="https://unpkg.com/jspsych@8.2.1/css/jspsych.css"
      rel="stylesheet"
      type="text/css"
    />
    <link href="../trials/css/custom.css" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/css?family=Questrial|Slabo+27px"
      rel="stylesheet"
    />
    <link
      href="https://use.fontawesome.com/releases/v5.0.7/css/all.css"
      rel="stylesheet"
    />
  </head>
  <body></body>
  <script>
    const enough_time = {
      type: jsPsychHtmlButtonResponse,
      stimulus:
        "<p class='instructions'>Before going further, please note that this study should take " +
        "15-17 minutes to complete.</p>",
      choices: ["I have enough time", "I do not have enough time"],
    };

    const not_enough_time_to_complete = {
      type: jsPsychHtmlButtonResponse,
      stimulus:
        "<p>Please come back later to take part in this experiment.</p>",
      choices: ["Go back to Prolific Academic"],
    };

    const redirect_to_prolific = {
      type: jsPsychCallFunction,
      func: function () {
        window.location.href = "https://www.prolific.ac/";
        jsPsych.pauseExperiment();
      },
    };

    const if_not_enough_time = {
      timeline: [not_enough_time_to_complete, redirect_to_prolific],
      conditional_function: function () {
        // get the data from the previous trial,
        // and check which key was pressed
        let trial_data = jsPsych.data.getLastTrialData().values()[0].response;
        if (trial_data == 1) {
          // participant says they don't have enough time
          return true;
        } else {
          // participant says they have enough time
          return false;
        }
      },
    };

    var jsPsych = initJsPsych({
      on_finish: function () {
        jsPsych.data.displayData();
      },
    });

    const timeline = [];

    timeline.push(enough_time, if_not_enough_time);

    // Launch experiment --------------------------------------------------------------------
    jsPsych.run(timeline);
  </script>
</html>
