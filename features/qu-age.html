<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <!-- jsPsych core library and plugins -->
    <script src="https://unpkg.com/jspsych@8.2.1"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-text@2.1.0"></script>

    <!-- style sheet -->
    <link
      href="https://unpkg.com/jspsych@8.2.1/css/jspsych.css"
      rel="stylesheet"
      type="text/css"
    />
    <link href="../trials/css/custom.css" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/css?family=Questrial|Slabo+27px"
      rel="stylesheet"
    />
    <link
      href="https://use.fontawesome.com/releases/v5.0.7/css/all.css"
      rel="stylesheet"
    />
  </head>
  <body></body>
  <script>
    const extra_information_age = {
      timeline: [
        {
          type: jsPsychSurveyText,
          questions: [
            { prompt: "How old are you?", required: true, name: "age" },
          ],
          button_label: "Confirm",
        },
      ],
      loop_function: function () {
        let trial_data = jsPsych.data.getLastTrialData().values()[0];
        let age = "";
        if (trial_data.response && trial_data.response.age !== undefined) {
          age = trial_data.response.age.trim();
        }
        // Checks whether the given answer is a number or not (if not, asks to answer again)
        if (!/^\d+$/.test(age) || parseInt(age) < 1) {
          alert("Please enter your age as a number (e.g., 25).");
          return true; // asks again
        }
        return false;
      },
    };

    var jsPsych = initJsPsych({
      on_finish: function () {
        jsPsych.data.displayData();
      },
    });

    const timeline = [];

    timeline.push(extra_information_age);

    // Launch experiment --------------------------------------------------------------------
    jsPsych.run(timeline);
  </script>
</html>
